
# join data, rename column, drop/keep column
joindata:
  TODO: TRUE
  table:
    -
      TODO: FALSE
      left:
        table: *kTableSchool
        suffix: *kTableDict
        by: *kColumnDistrictCode
      right:
        table: *kTableCity
        suffix: *kTableRaw
        select:
        by: *kColumnDistrictCode
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kTableSchool
        suffix: *kTableJoin

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kTableDict
        by: *kColumnSchoolCode
      right:
        table: *kTableSchool
        suffix: *kTableJoin
        select: # if no selected column, will keep all column
        by: *kColumnSchoolCode
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kTableStudent
        suffix: *kTableJoin

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kTableJoin
        by: *kColumnStudentCode
      right:
        table: *kSubjectCN
        suffix: *kTableRaw
        select:
          - *kColumnStudentCode
        add:
          -
            name: *kSubjectCN
            value: TRUE
        by: *kColumnStudentCode
      join.type: "left"
      out:
        table: *kTableStudent
        suffix: *kTableParticipate

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kTableParticipate
        by: *kColumnStudentCode
      right:
        table: *kSubjectMA
        suffix: *kTableRaw
        select:
          - *kColumnStudentCode
        add:
          -
            name: *kSubjectMA
            value: TRUE
        by: *kColumnStudentCode
      join.type: "left"
      out:
        table: *kTableStudent
        suffix: *kTableParticipate

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kTableParticipate
        by: *kColumnStudentCode
      right:
        table: *kSubjectEN
        suffix: *kTableRaw
        select:
          - *kColumnStudentCode
        add:
          -
            name: *kSubjectEN
            value: TRUE
        by: *kColumnStudentCode
      join.type: "left"
      out:
        table: *kTableStudent
        suffix: *kTableParticipate

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kTableParticipate
        by: *kColumnStudentCode
      right:
        table: *kSubjectSC
        suffix: *kTableRaw
        select:
          - *kColumnStudentCode
        add:
          -
            name: *kSubjectSC
            value: TRUE
        by: *kColumnStudentCode
      join.type: "left"
      out:
        table: *kTableStudent
        suffix: *kTableParticipate

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kTableParticipate
        by: *kColumnStudentCode
      right:
        table: *kSubjectAR
        suffix: *kTableRaw
        select:
          - *kColumnStudentCode
        add:
          -
            name: *kSubjectAR
            value: TRUE
        by: *kColumnStudentCode
      join.type: "left"
      out:
        table: *kTableStudent
        suffix: *kTableParticipate

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kTableParticipate
        by: *kColumnStudentCode
      right:
        table: *kRespondentST
        suffix: *kTableRaw
        select:
          - *kColumnStudentCode
        add:
          -
            name: *kRespondentST
            value: TRUE
        by: *kColumnStudentCode
      join.type: "left"
      out:
        table: *kTableStudent
        suffix: *kTableParticipate

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kTableParticipate
        by: *kColumnParentCode
      right:
        table: *kRespondentPA
        suffix: *kTableRaw
        select:
          - *kColumnParentCode
        add:
          -
            name: *kRespondentPA
            value: TRUE
        unique:
          - *kColumnParentCode
        by: *kColumnParentCode
      join.type: "left"
      out:
        table: *kTableStudent
        suffix: *kTableParticipate

    # join Fam12 from parent survey into student survey
    -
      TODO: FALSE
      left:
        table: *kRespondentST
        suffix: *kTableRaw
        by: *kColumnParentCode
      right:
        table: *kRespondentPA
        suffix: *kTableRaw
        select:
          - *kColumnParentCode
          - "Fam12"
        unique:
          - *kColumnParentCode
        by: *kColumnParentCode
      join.type: "left"
      drop:
        - *kColumnParentCode
      out:
        table: *kRespondentST
        suffix: *kTableJoin

    # join student info
    -
      TODO: FALSE
      left:
        table: *kRespondentST
        suffix: *kTableJoin
        by: *kColumnStudentCode
      right:
        table: *kTableStudent
        suffix: *kTableJoin
        by: *kColumnStudentCode
        <<: *kStatisticsAdd
      join.type: "left"
      out:
        table: *kRespondentST
        suffix: *kTableJoin

    -
      TODO: FALSE
      left:
        table: *kRespondentPA
        suffix: *kTableRaw
        by: *kColumnParentCode
      right:
        table: *kTableStudent
        suffix: *kTableJoin
        by: *kColumnParentCode
        <<: *kStatisticsAdd
      join.type: "left"
      out:
        table: *kRespondentPA
        suffix: *kTableJoin

    -
      TODO: FALSE
      left:
        table: *kSubjectCN
        suffix: *kTableRaw
        by: *kColumnStudentCode
      right:
        table: *kTableStudent
        suffix: *kTableJoin
        by: *kColumnStudentCode
        <<: *kStatisticsAdd
      join.type: "left"
      out:
        table: *kSubjectCN
        suffix: *kTableJoin

    -
      TODO: FALSE
      left:
        table: *kSubjectMA
        suffix: *kTableRaw
        by: *kColumnStudentCode
      right:
        table: *kTableStudent
        suffix: *kTableJoin
        by: *kColumnStudentCode
        <<: *kStatisticsAdd
      join.type: "left"
      out:
        table: *kSubjectMA
        suffix: *kTableJoin

    -
      TODO: FALSE
      left:
        table: *kSubjectEN
        suffix: *kTableRaw
        by: *kColumnStudentCode
      right:
        table: *kTableStudent
        suffix: *kTableJoin
        by: *kColumnStudentCode
        <<: *kStatisticsAdd
      join.type: "left"
      out:
        table: *kSubjectEN
        suffix: *kTableJoin

    -
      TODO: FALSE
      left:
        table: *kSubjectSC
        suffix: *kTableRaw
        by: *kColumnStudentCode
      right:
        table: *kTableStudent
        suffix: *kTableJoin
        by: *kColumnStudentCode
        <<: *kStatisticsAdd
      join.type: "left"
      out:
        table: *kSubjectSC
        suffix: *kTableJoin

    -
      TODO: FALSE
      left:
        table: *kSubjectAR
        suffix: *kTableRaw
        by: *kColumnStudentCode
      right:
        table: *kTableStudent
        suffix: *kTableJoin
        by: *kColumnStudentCode
        <<: *kStatisticsAdd
      join.type: "left"
      out:
        table: *kSubjectAR
        suffix: *kTableJoin
