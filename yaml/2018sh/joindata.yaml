
# join data, rename column, drop/keep column
joindata:
  TODO: TRUE
  # <<: *kDDLStatisticsTable
  table:
    -
      TODO: FALSE
      left:
        table: *kTableSchool
        suffix: *kSuffixDict
        by: *kColumnDistrictCode
      right:
        table: *kTableDistrict
        suffix: *kSuffixRaw
        select:
        by: *kColumnDistrictCode
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kTableSchool
        suffix: *kSuffixJoin

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kSuffixDict
        by: *kColumnSchoolCode
      right:
        table: *kTableSchool
        suffix: *kSuffixJoin
        select: # if no selected column, will keep all column
        by: *kColumnSchoolCode
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kTableStudent
        suffix: *kSuffixJoin

    -
      TODO: FALSE
      left:
        table: *kTableTeacher
        suffix: *kSuffixRaw
        by: *kColumnSchoolCode
      right:
        table: *kTableSchool
        suffix: *kSuffixJoin
        select: # if no selected column, will keep all column
        by: *kColumnSchoolCode
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kTableTeacher
        suffix: *kSuffixJoin

    -
      TODO: FALSE
      left:
        table: *kTablePrincipal
        suffix: *kSuffixRaw
        by: *kColumnSchoolCode
      right:
        table: *kTableSchool
        suffix: *kSuffixJoin
        select: # if no selected column, will keep all column
        by: *kColumnSchoolCode
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kTablePrincipal
        suffix: *kSuffixJoin

    # join student participate
    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kSuffixJoin
        by: *kColumnStudentCode
      right:
        table: *kSubjectCN
        suffix: *kSuffixRaw
        select:
          - *kColumnStudentCode
        add:
          -
            name: *kSubjectCN
            value: TRUE
        by: *kColumnStudentCode
      join.type: "left"
      out:
        table: *kTableStudent
        suffix: *kSuffixExamination

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kSuffixExamination
        by: *kColumnStudentCode
      right:
        table: *kSubjectMA
        suffix: *kSuffixRaw
        select:
          - *kColumnStudentCode
        add:
          -
            name: *kSubjectMA
            value: TRUE
        by: *kColumnStudentCode
      join.type: "left"
      out:
        table: *kTableStudent
        suffix: *kSuffixExamination

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kSuffixExamination
        by: *kColumnStudentCode
      right:
        table: *kSubjectEN
        suffix: *kSuffixRaw
        select:
          - *kColumnStudentCode
        add:
          -
            name: *kSubjectEN
            value: TRUE
        by: *kColumnStudentCode
      join.type: "left"
      out:
        table: *kTableStudent
        suffix: *kSuffixExamination

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kSuffixExamination
        by: *kColumnStudentCode
      right:
        table: *kSubjectSC
        suffix: *kSuffixRaw
        select:
          - *kColumnStudentCode
        add:
          -
            name: *kSubjectSC
            value: TRUE
        by: *kColumnStudentCode
      join.type: "left"
      out:
        table: *kTableStudent
        suffix: *kSuffixExamination

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kSuffixExamination
        by: *kColumnStudentCode
      right:
        table: *kSubjectAR
        suffix: *kSuffixRaw
        select:
          - *kColumnStudentCode
        add:
          -
            name: *kSubjectAR
            value: TRUE
        by: *kColumnStudentCode
      join.type: "left"
      out:
        table: *kTableStudent
        suffix: *kSuffixExamination

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kSuffixExamination
        by: *kColumnStudentCode
      right:
        table: *kRespondentST
        suffix: *kSuffixRaw
        select:
          - *kColumnStudentCode
        add:
          -
            name: *kRespondentST
            value: TRUE
        by: *kColumnStudentCode
      join.type: "left"
      out:
        table: *kTableStudent
        suffix: *kSuffixParticipate

    -
      TODO: FALSE
      left:
        table: *kTableStudent
        suffix: *kSuffixParticipate
        by: *kColumnParentCode
      right:
        table: *kRespondentPA
        suffix: *kSuffixRaw
        select:
          - *kColumnParentCode
        add:
          -
            name: *kRespondentPA
            value: TRUE
        unique:
          - *kColumnParentCode
        by: *kColumnParentCode
      join.type: "left"
      out:
        table: *kTableStudent
        suffix: *kSuffixParticipate

    # join Fam12 from parent survey into student survey
    -
      TODO: FALSE
      left:
        table: *kRespondentST
        suffix: *kSuffixRaw
        by: *kColumnParentCode
      right:
        table: *kRespondentPA
        suffix: *kSuffixRaw
        select:
          - *kColumnParentCode
          - "Fam12"
        unique:
          - *kColumnParentCode
        by: *kColumnParentCode
      join.type: "left"
      drop:
        - *kColumnParentCode
      out:
        table: *kRespondentST
        suffix: *kSuffixJoin

    # join student, school  into info
    -
      TODO: FALSE
      left:
        table: *kRespondentST
        suffix: *kSuffixJoin
        by: *kColumnStudentCode
      right:
        table: *kTableStudent
        suffix: *kSuffixJoin
        select:
        by: *kColumnStudentCode
        # <<: *kStatisticsAdd
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kRespondentST
        suffix: *kSuffixJoin

    -
      TODO: FALSE
      left:
        table: *kRespondentPA
        suffix: *kSuffixRaw
        by: *kColumnParentCode
      right:
        table: *kTableStudent
        suffix: *kSuffixJoin
        select:
        by: *kColumnParentCode
        # <<: *kStatisticsAdd
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kRespondentPA
        suffix: *kSuffixJoin


    -
      TODO: FALSE
      left:
        table: *kRespondentTE
        suffix: *kSuffixRaw
        by: *kColumnTeacherCode
      right:
        table: *kTableTeacher
        suffix: *kSuffixJoin
        select:
        by: *kColumnTeacherCode
        # <<: *kStatisticsAdd
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kRespondentTE
        suffix: *kSuffixJoin

    -
      TODO: FALSE
      left:
        table: *kSubjectCN
        suffix: *kSuffixRaw
        by: *kColumnStudentCode
      right:
        table: *kTableStudent
        suffix: *kSuffixJoin
        select:
        by: *kColumnStudentCode
        # <<: *kStatisticsAdd
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kSubjectCN
        suffix: *kSuffixJoin

    -
      TODO: FALSE
      left:
        table: *kSubjectMA
        suffix: *kSuffixRaw
        by: *kColumnStudentCode
      right:
        table: *kTableStudent
        suffix: *kSuffixJoin
        select:
        by: *kColumnStudentCode
        # <<: *kStatisticsAdd
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kSubjectMA
        suffix: *kSuffixJoin

    -
      TODO: FALSE
      left:
        table: *kSubjectEN
        suffix: *kSuffixRaw
        by: *kColumnStudentCode
      right:
        table: *kTableStudent
        suffix: *kSuffixJoin
        select:
        by: *kColumnStudentCode
        # <<: *kStatisticsAdd
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kSubjectEN
        suffix: *kSuffixJoin

    -
      TODO: FALSE
      left:
        table: *kSubjectSC
        suffix: *kSuffixRaw
        by: *kColumnStudentCode
      right:
        table: *kTableStudent
        suffix: *kSuffixJoin
        select:
        by: *kColumnStudentCode
        # <<: *kStatisticsAdd
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kSubjectSC
        suffix: *kSuffixJoin

    -
      TODO: FALSE
      left:
        table: *kSubjectAR
        suffix: *kSuffixRaw
        by: *kColumnStudentCode
      right:
        table: *kTableStudent
        suffix: *kSuffixJoin
        select:
        by: *kColumnStudentCode
        # <<: *kStatisticsAdd
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kSubjectAR
        suffix: *kSuffixJoin
