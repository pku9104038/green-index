
# join data, rename column, drop/keep column
joindata:
  TODO: FALSE
  table:
    -
      TODO: TRUE
      left:
        table: *kTableSchool
        suffix: *kTableDict
        by: "区编码"
      right:
        table: *kTableCity
        suffix: *kTableRaw
        select:
        by: "区编码"
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kTableSchool
        suffix: *kTableJoin

    -
      TODO: TRUE
      left:
        table: *kTableStudent
        suffix: *kTableDict
        by: "学校编码"
      right:
        table: *kTableSchool
        suffix: *kTableJoin
        select: # if no selected column, will keep all column
        by: "学校编码"
      join.type: "left" # "inner", left", "right", "full"
      out:
        table: *kTableStudent
        suffix: *kTableJoin

    -
      TODO: FALSE
      left:
        table: *kRespondentST
        suffix: *kTableJoin
        by: "准考证号"
      right:
        table: *kSubjectCN
        suffix: *kTableJoin
        select:
          - "准考证号"
        by: "准考证号"
      join.type: "full"
      drop:
      rename:
      keep:
        - "准考证号"
        - *kRespondentST
        - *kSubjectCN
      out:
        table: *kTableStudentJoin
        suffix: ""

    -
      TODO: FALSE
      left:
        table: *kTableStudentJoin
        suffix: ""
        by: "准考证号"
      right:
        table: *kSubjectMA
        suffix: *kTableJoin
        select:
          - "准考证号"
        by: "准考证号"

      join.type: "full"
      drop:
      rename:
      keep:
      out:
        table: *kTableStudentJoin
        suffix: ""

    -
      TODO: FALSE
      left:
        table: *kTableStudentJoin
        suffix: ""
        by: "准考证号"
      right:
        table: *kSubjectEN
        suffix: *kTableJoin
        select:
          - "准考证号"
        by: "准考证号"
        set:
          - *kSubjectEN
      join.type: "full"
      drop:
      rename:
      keep:
      out:
        table: *kTableStudentJoin
        suffix: ""

    -
      TODO: FALSE
      left:
        table: *kTableStudentJoin
        suffix: ""
        by: "准考证号"
      right:
        table: *kSubjectSC
        suffix: *kTableJoin
        select:
          - "准考证号"
        by: "准考证号"
        set:
          - *kSubjectSC
      join.type: "full"
      drop:
      rename:
      keep:
      out:
        table: *kTableStudentJoin
        suffix: ""

    -
      TODO: FALSE
      left:
        table: *kTableStudentJoin
        suffix: ""
        by: "准考证号"
      right:
        table: *kSubjectAR
        suffix: *kTableJoin
        select:
          - "准考证号"
        by: "准考证号"
        set:
          - *kSubjectAR
      join.type: "full"
      drop:
      rename:
      keep:
      out:
        table: *kTableStudentJoin
        suffix: ""

    -
      TODO: FALSE
      left:
        table: *kTableStudentJoin
        suffix: ""
        by: "准考证号"
      right:
        table: *kRespondentPA
        suffix: *kTableJoin
        select:
          - "准考证号"
        by: "准考证号"
        set:
          - *kRespondentPA
      join.type: "full"
      drop:
      rename:
      keep:
      out:
        table: *kTableStudentJoin
        suffix: ""

    -
      TODO: FALSE
      left:
        table: *kTableStudentJoin
        suffix: ""
        by: "准考证号"
      right:
        table: *kTableStudent
        suffix: ""
        select:
          - "准考证号"
          - "区"
          - "学校"
        by: "准考证号"
      join.type: "left"
      drop:
      rename:
      keep:
      out:
        table: *kTableStudentJoin
        suffix: ""

    # join Fam12 from parent survey into student survey
    -
      TODO: FALSE
      left:
        table: *kRespondentST
        suffix: *kTableJoin
        by: "准考证号"
      right:
        table: *kRespondentPA
        suffix: *kTableJoin
        select:
          - "准考证号"
          - "Fam12"
        by: "准考证号"
      join.type: "left"
      drop:
      rename:
      keep:
      out:
        table: *kRespondentST
        suffix: *kTableJoin
